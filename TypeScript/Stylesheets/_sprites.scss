@use 'sass:map';
@use 'generated/_gender';
@use 'generated/_sprite-list';
@use 'generated/_sprite-url';

@mixin sprite($name) {
    $icon: map.get(sprite-list.$sprites, $name);

    @if $icon {
        background-repeat: no-repeat;
        $x: map.get($icon, 'x');
        $y: map.get($icon, 'y');

        background-position:
            calc(#{$x} + var(--sprite-offset-x, 0px))
            calc(#{$y} + var(--sprite-offset-y, 0px));
    } @else {
        @warn "Sprite `#{$name}` not found in $sprites map.";
    }
}

[data-gender],
[data-gender-icon] {
    position: relative;
    display: inline-block;

    &::before,
    &::after {
        display: block;
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
    }
}

[data-gender='FF'],
[data-gender='FM'] {
    &[data-gender-type='trans'] {
        --gender-glyph-l-color: var(--color-fg-ft);
        --gender-glyph-r-color: var(--color-bg-ft);
    }
    &[data-gender-type='cis'] {
        --gender-glyph-l-color: var(--color-fg-fc);
        --gender-glyph-r-color: var(--color-bg-fc);
    }

}
[data-gender='XF'],
[data-gender='XX'],
[data-gender='XM'] {
    &[data-gender-type='trans'] {
        --gender-glyph-l-color: var(--color-xt);
    }
    &[data-gender-type='cis'] {
        --gender-glyph-l-color: var(--color-xc);
    }

    --gender-glyph-r-color: var(--color-x);
}
[data-gender='MF'],
[data-gender='MM'] {
    &[data-gender-type='trans'] {
        --gender-glyph-l-color: var(--color-fg-mt);
        --gender-glyph-r-color: var(--color-bg-mt);
    }
    &[data-gender-type='cis'] {
        --gender-glyph-l-color: var(--color-fg-mc);
        --gender-glyph-r-color: var(--color-bg-mc);
    }
}


[data-gender='FF'] {
    --gender-glyph-l: var(--icon-ff-l);
    --gender-glyph-r: var(--icon-ff-r);
}
[data-gender='FM'] {
    --gender-glyph-l: var(--icon-fm-l);
    --gender-glyph-r: var(--icon-fm-r);
}
[data-gender='XF'] {
    --gender-glyph-l: var(--icon-xf-l);
    --gender-glyph-r: var(--icon-xf-r);
}
[data-gender='XX'] {
    --gender-glyph-l: var(--icon-xx-l);
    --gender-glyph-r: var(--icon-xx-r);
}
[data-gender='XM'] {
    --gender-glyph-l: var(--icon-xm-l);
    --gender-glyph-r: var(--icon-xm-r);
}
[data-gender='MF'] {
    --gender-glyph-l: var(--icon-mf-l);
    --gender-glyph-r: var(--icon-mf-r);
}
[data-gender='MM'] {
    --gender-glyph-l: var(--icon-mm-l);
    --gender-glyph-r: var(--icon-mm-r);
}
[data-gender] {
    min-width: 20px;
    height: 30px;

    &::before,
    &::after {
        content: '';

        mask-size: cover;
        mask-repeat: no-repeat;
        mask-position: center;
    }

    &::before {
        mask-image: var(--gender-glyph-r);
        background-color: var(--gender-glyph-r-color);
    }
    &::after {
        mask-image: var(--gender-glyph-l);
        background-color: var(--gender-glyph-l-color);
    }
}

[data-gender-icon='SF'] {
    --gender-glyph: var(--icon-ff-l);
}
[data-gender-icon='SX'] {
    --gender-glyph: var(--icon-xx-l);
}
[data-gender-icon='SM'] {
    --gender-glyph: var(--icon-mm-l);
}

[data-pop-type='A'] {
    --pop-stratum-color-rgba: rgb(255, 109, 51);
    --pop-stratum-color: 255, 109, 51;
}
[data-pop-type='E'],
[data-pop-type='S'],
[data-pop-type='M'],
[data-pop-type='C'],
[data-pop-type='D'] {
    --pop-stratum-color-rgba: rgb(255, 51, 51);
    --pop-stratum-color: 255, 51, 51;
}
[data-pop-type='G'],
[data-pop-type='F'],
[data-pop-type='X'],
[data-pop-type='I'] {
    --pop-stratum-color-rgba: rgb(255, 217, 112);
    --pop-stratum-color: 255, 217, 112;
}
[data-pop-type='O'],
[data-pop-type='P'] {
    --pop-stratum-color-rgba: rgb(106, 65, 255);
    --pop-stratum-color: 106, 65, 255;
}

[data-term-id='pA'] > span.label::before,
[data-pop-type='A'] > span {
    @include sprite(handmaid);
}
[data-term-id='pS'] > span.label::before,
[data-pop-type='S'] > span {
    @include sprite(maid);
}
[data-term-id='pG'] > span.label::before,
[data-pop-type='G'] > span {
    @include sprite(doctor);
}
[data-term-id='pD'] > span.label::before,
[data-pop-type='D'] > span {
    @include sprite(driver);
}
[data-term-id='pC'] > span.label::before,
[data-pop-type='C'] > span {
    @include sprite(contractor);
}
[data-term-id='pE'] > span.label::before,
[data-pop-type='E'] > span {
    @include sprite(editor);
}
[data-term-id='pF'] > span.label::before,
[data-pop-type='F'] > span {
    @include sprite(farmer);
}
[data-term-id='pX'] > span.label::before,
[data-pop-type='X'] > span {
    @include sprite(lawyer);
}
[data-term-id='pI'] > span.label::before,
[data-pop-type='I'] > span {
    @include sprite(influencer);
}
[data-term-id='pM'] > span.label::before,
[data-pop-type='M'] > span {
    @include sprite(astronaut);
}
[data-term-id='pO'] > span.label::before,
[data-pop-type='O'] > span {
    @include sprite(businesswoman);
}
[data-term-id='pP'] > span.label::before,
[data-pop-type='P'] > span {
    @include sprite(spokeswoman);
}

[data-term-id^='p'] > span.label::before {
    content: '';
}
[data-term-id^='p'] > span.label::before,
[data-pop-type] > span {
    display: block;
    height: 30px;
    width: 30px;

    background-image: url(sprite-url.$spritesheet-url);
    --sprite-offset-x: -13px;
}

[data-term-id^='p'] > span.label,
[data-pop-type] {
    display: block;
    width: 30px;
    background: radial-gradient(
        rgba(211, 223, 255, 0.5),
        transparent 75%,
    );
}

[data-map-layer='Terrain'] {
    --text-icon: 'ğŸŒ³';
}
[data-map-layer='Population'] {
    --text-icon: 'ğŸ‘¥';
}
[data-map-layer='AverageMilitancy'] {
    --text-icon: 'ğŸ’¥';
}
[data-map-layer='AverageConsciousness'] {
    --text-icon: 'ğŸ’­';
}
